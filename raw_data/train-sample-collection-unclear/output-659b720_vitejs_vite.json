{
  "commit_index": "659b720",
  "commit_url": "https://github.com/vitejs/vite/commit/659b7206930d660779ad504beef89744fb97d339",
  "commit": {
    "commit_message": [
      "fix",
      "build",
      "handle",
      "invalid",
      "json",
      "import.meta.env",
      "17648"
    ],
    "description": [
      "co-authored-by",
      "bluwy",
      "bjornlu.dev",
      "gmail.com"
    ],
    "changed_files_count": 5,
    "changed_files": [
      "packages/vite/src/node/__tests__/plugins/define.spec.ts",
      "packages/vite/src/node/plugins/define.ts",
      "playground/define/__tests__/define.spec.ts",
      "playground/define/index.html",
      "playground/define/vite.config.js"
    ],
    "changed_files_content": [],
    "parent": "952bae3efcbd871fc3df5b1947060de7ebdafa36"
  },
  "pull_requests": [
    {
      "pr_title": [
        "fix",
        "build",
        "handle",
        "invalid",
        "json",
        "import.meta.env",
        "17648"
      ],
      "total_discussions": 27,
      "discussions": [
        {
          "discussion_number": 1,
          "comments": [
            {
              "type": "pr_description",
              "content": [
                "bug",
                "reproductionfix",
                "17710note",
                "bluwy",
                "solution",
                "description",
                "outdated",
                "new",
                "solution",
                "based",
                "17648",
                "comment",
                "whenimport.meta.envhas",
                "invalid",
                "json",
                "value",
                "as__vite_is_legacy__imported",
                "vitejs/plugin-legacy",
                "vite",
                "replace",
                "theimport.meta.envinimport.meta.env.somevar_undefinedto",
                "plain",
                "object",
                "javascript",
                "file",
                "invalid",
                "javascript",
                "file",
                "produce",
                "error",
                "handled",
                "proceedingcommonjsplugin.the",
                "minimum",
                "reproducible",
                "set",
                "http",
                "//stackblitz.com/edit/stackblitz-starters-xr8lwk",
                "file=index.htmlreasonas",
                "previous",
                "description",
                "vite",
                "defineplugin",
                "replaceimport.meta.env.somevar_undefinedto",
                "base_url",
                "mode",
                "development",
                "dev",
                "true",
                "prod",
                "false",
                "ssr",
                "false",
                "legacy",
                "__vite_is_legacy__",
                ".somevar_undefined.the",
                "reason",
                "vite",
                "definewill",
                "replace",
                "actualimport.meta.envwith",
                "marker.vite/packages/vite/src/node/plugins/define.tslines",
                "144",
                "148",
                "in167006eif",
                "env",
                "canjsonparse",
                "env",
                "constmarker=",
                "gethash",
                "env",
                "env.length-2",
                "replacementmarkers",
                "marker",
                "=envdefine=",
                "...",
                "define",
                "'import.meta.env",
                "marker",
                "original",
                "value",
                "ofimport.meta.envis",
                "object",
                "marker",
                "identifier",
                "replace",
                "strategy",
                "ofesbuildto",
                "handle",
                "two",
                "type",
                "different.replacement",
                "expression",
                "array",
                "object",
                "substituted",
                "inline",
                "mean",
                "participate",
                "constant",
                "folding",
                "array",
                "object",
                "replacement",
                "expression",
                "stored",
                "variable",
                "referenced",
                "using",
                "identifier",
                "instead",
                "substituted",
                "inline",
                "avoids",
                "substituting",
                "repeated",
                "copy",
                "value",
                "mean",
                "value",
                "n't",
                "participate",
                "constant",
                "folding.",
                "--",
                "esbuild",
                "documentationconsider",
                "following",
                "example.import.meta.env.somevar_undefinedimport.meta.env.somevar_undefinedwhenimport.meta.envis",
                "identifier",
                "esbuildwill",
                "replace",
                "place._hashgeneratedbyvitedefine_.somevar_undefined_hashgeneratedbyvitedefine_.somevar_undefinedafter",
                "vite",
                "definewill",
                "replace",
                "marker",
                "originalimport.meta.envvite/packages/vite/src/node/plugins/define.tslines",
                "181",
                "183",
                "in167006efor",
                "constmarkerinreplacementmarkers",
                "result.code=result.code.replaceall",
                "marker",
                "replacementmarkers",
                "marker",
                "base_url",
                "mode",
                "development",
                "dev",
                "true",
                "prod",
                "false",
                "ssr",
                "false",
                "legacy",
                "__vite_is_legacy__",
                ".somevar_undefined",
                "base_url",
                "mode",
                "development",
                "dev",
                "true",
                "prod",
                "false",
                "ssr",
                "false",
                "legacy",
                "__vite_is_legacy__",
                ".somevar_undefinednow",
                "'s",
                "invalid",
                "javascript",
                "code.solutionalign",
                "type",
                "original",
                "marker.i",
                "generate",
                "marker",
                "valid",
                "json",
                "replace",
                "strategy",
                "same.radical",
                "solutioni",
                "found",
                "value",
                "ofimport.meta.envis",
                "spread",
                "config",
                "loader",
                "j",
                "charset",
                "utf8",
                "platform",
                "neutral",
                "define",
                "process.env",
                "global.process.env",
                "globalthis.process.env",
                "process.env.node_env",
                "production\\",
                "global.process.env.node_env",
                "production\\",
                "globalthis.process.env.node_env",
                "production\\",
                "import.meta.hot",
                "undefined",
                "import.meta.env.base_url",
                "/\\",
                "import.meta.env.mode",
                "production\\",
                "import.meta.env.dev",
                "false",
                "import.meta.env.prod",
                "true",
                "import.meta.env.ssr",
                "false",
                "import.meta.env.legacy",
                "__vite_is_legacy__",
                "import.meta.env",
                "_ecc578fd856ad0ab7198de04a00b9405c7a6d2549217f51adfff717ee9f7b851______________________________________________",
                "sourcefile",
                "/users/yuzheng14/code/repositories/legacy-conflict/node_modules/.pnpm/vue",
                "2.7.16/node_modules/vue/dist/vue.runtime.esm.js",
                "sourcemap",
                "false",
                "andesbuildwill",
                "replace",
                "first.under",
                "case",
                "import.env.metawill",
                "replace",
                "value",
                "defined",
                "leave",
                "forimport.meta.envjust",
                "likeprocess.env",
                "vite/packages/vite/src/node/plugins/define.tslines",
                "20",
                "27",
                "in167006eobject.assign",
                "processenv",
                "'process.env",
                "'global.process.env",
                "'globalthis.process.env",
                "'process.env.node_env",
                "json.stringify",
                "nodeenv",
                "'global.process.env.node_env",
                "json.stringify",
                "nodeenv",
                "'globalthis.process.env.node_env",
                "json.stringify",
                "nodeenv",
                "could",
                "n't",
                "aware",
                "side",
                "effect",
                "solution",
                "choose",
                "modify",
                "generation",
                "marker"
              ],
              "author": "bluwy"
            }
          ]
        },
        {
          "discussion_number": 2,
          "comments": [
            {
              "content": [
                "run",
                "review",
                "pull",
                "request",
                "instackblitz",
                "codeflow"
              ]
            }
          ]
        },
        {
          "discussion_number": 3,
          "comments": [
            {
              "content": [
                "bluwycould",
                "please",
                "take",
                "time",
                "review",
                "pull",
                "request"
              ]
            }
          ]
        },
        {
          "discussion_number": 4,
          "comments": [
            {
              "content": [
                "bluwyi",
                "saw",
                "viewed",
                "pr",
                "worth",
                "merging",
                "failure"
              ]
            }
          ]
        },
        {
          "discussion_number": 5,
          "comments": [
            {
              "content": [
                "concern",
                "trick",
                "maybe",
                "need",
                "different",
                "approach",
                "solve",
                "perhaps",
                "simply",
                "replaceimport.meta.envas__vite_import_meta_env__and",
                "append",
                "theconst",
                "__vite_import_meta_env__",
                "...",
                "manually",
                "way",
                "imitate",
                "esbuild",
                "'s",
                "json",
                "object",
                "handling",
                "without",
                "post-replacement",
                "use",
                "esbuild'sbanneroption",
                "sourcemap",
                "also",
                "handled",
                "automatically",
                "build",
                "regex",
                "with__vite_import_meta_env__.",
                ".+",
                "\\bto",
                "identify",
                "unused",
                "env",
                "var",
                "ahead",
                "time",
                "replacingimport.meta.env.somevar_undefinedwithundefined",
                "case",
                "import.env.metawill",
                "replace",
                "value",
                "defined",
                "leave",
                "forimport.meta.envjust",
                "likeprocess.env",
                "user",
                "doesconsole.log",
                "import.meta.env",
                "log",
                "entire",
                "object",
                "n't",
                "happen",
                "forprocess.envas",
                "may",
                "contain",
                "sensitive",
                "information"
              ]
            }
          ]
        },
        {
          "discussion_number": 6,
          "comments": [
            {
              "content": [
                "ok",
                "got",
                "'ll",
                "try",
                "implement"
              ]
            }
          ]
        },
        {
          "discussion_number": 7,
          "comments": [
            {
              "content": [
                "bluwyi",
                "finished",
                "replace",
                "undefinedimport.meta.envkey",
                "usingdefine",
                "add",
                "manual__vite_import_meta_env__banner",
                "bareimport.meta.env"
              ]
            }
          ]
        },
        {
          "discussion_number": 8,
          "comments": [
            {
              "content": [
                "bluwynow",
                "replacesimport.meta.envafterreplacedefine",
                "need",
                "generate",
                "sourcemap",
                "replaces",
                "usingmagic-stringto",
                "generate",
                "replace",
                "using",
                "regex",
                "directly",
                "think",
                "need",
                "capture",
                "key",
                "still",
                "key",
                "key",
                "supposed",
                "undefined",
                "inimport.meta.env"
              ]
            }
          ]
        },
        {
          "discussion_number": 9,
          "comments": [
            {
              "content": [
                "think",
                "need",
                "capture",
                "key",
                "still",
                "key",
                "key",
                "supposed",
                "undefined",
                "inimport.meta.env",
                "good",
                "point",
                "'s",
                "nice",
                "optimization",
                "bluwynow",
                "replacesimport.meta.envafterreplacedefine",
                "need",
                "generate",
                "sourcemap",
                "replaces",
                "usingmagic-stringto",
                "generate",
                "replace",
                "using",
                "regex",
                "directly",
                "n't",
                "think",
                "sourcemap",
                "handling",
                "expensive",
                "'ll",
                "push",
                "commits",
                "test",
                "locally",
                "apply",
                "trick",
                "mentioned",
                "faster"
              ]
            }
          ]
        },
        {
          "discussion_number": 10,
          "comments": [
            {
              "content": [
                "n't",
                "think",
                "sourcemap",
                "handling",
                "expensive",
                "'ll",
                "push",
                "commits",
                "test",
                "locally",
                "apply",
                "trick",
                "mentioned",
                "faster",
                "replace",
                "undefined",
                "key",
                "undefined",
                "afterreplacedefine",
                "however",
                "idea",
                "sourcemap",
                "way",
                "n't",
                "aware",
                "sourcemap",
                "usedmagic-string",
                "premise",
                "usemagic-stringto",
                "prepend",
                "banner",
                "think",
                "uncommon",
                "situation",
                "little",
                "expense",
                "may",
                "tolerated"
              ]
            }
          ]
        },
        {
          "discussion_number": 11,
          "comments": [
            {
              "content": [
                "pushed",
                "commits",
                "optimize",
                "sourcemap",
                "handling",
                "agree",
                "bareimport.meta.envor",
                "unknownimport.meta.env",
                "rare",
                "think",
                "since",
                "refactor",
                "also",
                "simplifies",
                "code",
                "'s",
                "worth",
                "test",
                "pas",
                "'ll",
                "run",
                "ecosystem-ci",
                "good",
                "go",
                "also",
                "verified",
                "trickworks"
              ]
            }
          ]
        },
        {
          "discussion_number": 12,
          "comments": [
            {
              "content": [
                "/ecosystem-ci",
                "run"
              ]
            }
          ]
        },
        {
          "discussion_number": 13,
          "comments": [
            {
              "content": [
                "ran",
                "ecosystem",
                "ci",
                "onaf23b75",
                "open",
                "\u2705analogjs",
                "histoire",
                "ladle",
                "laravel",
                "marko",
                "previewjs",
                "quasar",
                "qwik",
                "rakkas",
                "remix",
                "sveltekit",
                "unocss",
                "vite-plugin-pwa",
                "vite-plugin-react",
                "vite-plugin-react-swc",
                "vite-plugin-svelte",
                "vite-plugin-vue",
                "vite-setup-catalogue",
                "vitepress"
              ]
            }
          ]
        },
        {
          "discussion_number": 14,
          "comments": [
            {
              "content": [
                "saw",
                "ecosystem-ci",
                "fail",
                "anything"
              ]
            }
          ]
        },
        {
          "discussion_number": 15,
          "comments": [
            {
              "content": [
                "ignore",
                "latest",
                "scheduled",
                "result",
                "main",
                "pr",
                "n't",
                "causing",
                "fails",
                "'m",
                "waiting",
                "another",
                "review",
                "merging"
              ]
            }
          ]
        },
        {
          "discussion_number": 16,
          "comments": [
            {
              "content": [
                "okay",
                "everyone",
                "reviewing",
                "pr"
              ]
            }
          ]
        },
        {
          "discussion_number": 17,
          "comments": [
            {
              "content": [
                "seems",
                "since",
                "change",
                "'m",
                "running",
                "intoidentifier",
                "__vite_import_meta_env__",
                "already",
                "declarederrors",
                "build",
                "'s",
                "bundling",
                "library",
                "built",
                "also",
                "built",
                "vite",
                "'s",
                "also",
                "unexpected",
                "this__vite_import_meta_env__variable",
                "added",
                "j",
                "output",
                "library",
                "even",
                "though",
                "useimport.meta.envat"
              ]
            }
          ]
        },
        {
          "discussion_number": 18,
          "comments": [
            {
              "content": [
                "seems",
                "since",
                "change",
                "'m",
                "running",
                "intoidentifier",
                "__vite_import_meta_env__",
                "already",
                "declarederrors",
                "build",
                "'s",
                "bundling",
                "library",
                "built",
                "also",
                "built",
                "vite",
                "'s",
                "also",
                "unexpected",
                "this__vite_import_meta_env__variable",
                "added",
                "j",
                "output",
                "library",
                "even",
                "though",
                "useimport.meta.envat",
                "please",
                "provide",
                "issue",
                "describe",
                "detail"
              ]
            }
          ]
        },
        {
          "discussion_number": 19,
          "comments": [
            {
              "content": [
                "hard",
                "time",
                "creating",
                "reproduction",
                "issue",
                "without",
                "reproduction",
                "would",
                "rejected",
                "full",
                "error",
                "compiled",
                "output",
                "lib",
                "hasminify",
                "false",
                "var",
                "name",
                "go",
                "unmodified",
                "three",
                "variable",
                "edit",
                "wip",
                "reproduction",
                "athttps",
                "//github.com/silverwind/vite-import-meta",
                "reproduce",
                "yet"
              ]
            }
          ]
        },
        {
          "discussion_number": 20,
          "comments": [
            {
              "content": [
                "library",
                "error",
                "namedlib",
                "saw",
                "file",
                "isnode_modules/lib/dist/index.js"
              ]
            }
          ]
        },
        {
          "discussion_number": 21,
          "comments": [
            {
              "content": [
                "think",
                "one",
                "scenario",
                "happen",
                "library",
                "code",
                "dependency",
                "include",
                "bothimport.meta.envandprocess.envsilverwind/vite-import-meta",
                "1",
                "later",
                "main",
                "app",
                "build",
                "vite",
                "definetransformslib/dist/index.jssince",
                "'s",
                "left",
                "withprocess.env",
                "probably",
                "end",
                "detecting__vite_import_meta_env__and",
                "injecting",
                "banner__vite_import_meta_env__again"
              ]
            }
          ]
        },
        {
          "discussion_number": 22,
          "comments": [
            {
              "content": [
                "need",
                "use",
                "bareimport.meta.envin",
                "production",
                "output",
                "library",
                "need",
                "use",
                "conditional",
                "operation",
                "code",
                "use",
                "vite",
                "bundle",
                "replaceimport.meta.env.something_undefinedtoundefineddirectly",
                "object",
                "including",
                "value",
                "ofimport.meta.envin",
                "past",
                "version"
              ]
            }
          ]
        },
        {
          "discussion_number": 23,
          "comments": [
            {
              "content": [
                "need",
                "use",
                "bareimport.meta.envin",
                "production",
                "output",
                "library",
                "need",
                "use",
                "conditional",
                "operation",
                "code",
                "use",
                "vite",
                "bundle",
                "replaceimport.meta.env.something_undefinedtoundefineddirectly",
                "object",
                "including",
                "value",
                "ofimport.meta.envin",
                "past",
                "version",
                "clarify",
                "code",
                "example",
                "wild",
                "zustandin",
                "casehttps",
                "//github.com/pmndrs/zustand/blob/a56e76db5261291dcf9a88573dac58f67edb93db/rollup.config.js",
                "l67-l70",
                "concern",
                "vite",
                "library",
                "mode",
                "author",
                "might",
                "happen",
                "use",
                "dependency",
                "without",
                "externalized",
                "leave__vite_import_meta_env__in",
                "library",
                "output",
                "unnoticed",
                "think",
                "rather",
                "edge",
                "case",
                "ideally",
                "desired",
                "handled",
                "robustly",
                "somehow",
                "another",
                "package",
                "remembered",
                "might",
                "cause",
                "issue",
                "unjs",
                "'s",
                "std-envhttps",
                "//github.com/unjs/std-env/blob/b4ef16832baf4594ece7796a2c1805712fde70a3/src/env.ts",
                "us",
                "bareimport.meta.envandprocess.env",
                "library",
                "mode",
                "build",
                "dependency",
                "bundled",
                "issue",
                "would",
                "probably",
                "happen"
              ]
            }
          ]
        },
        {
          "discussion_number": 24,
          "comments": [
            {
              "content": [
                "maybe",
                "create",
                "issue",
                "tozustandbecause",
                "need",
                "replaceimport.meta.env",
                ".modewith",
                "import.meta.env",
                "import.meta.env.mode",
                "undefined",
                ".esbuildcan",
                "replaceimport.meta.env",
                ".modeto",
                "value",
                "example",
                "ouputconsole.log",
                "production"
              ]
            }
          ]
        },
        {
          "discussion_number": 25,
          "comments": [
            {
              "content": [
                "yes",
                "zustand",
                "well",
                "case",
                "well",
                "usesimport.meta.envin",
                "theiroriginal",
                "code",
                "apparently",
                "bundler",
                "rollup",
                "transpilesimport.meta.env",
                ".mode",
                "==",
                "'production'toprocess.env.node_env",
                "==",
                "production",
                "think",
                "'s",
                "fine",
                "zustand",
                "logging",
                "runtime",
                "deprecation",
                "warning",
                "dev",
                "mode"
              ]
            }
          ]
        },
        {
          "discussion_number": 26,
          "comments": [
            {
              "content": [
                "okay",
                "'ll",
                "try",
                "reproduce",
                "make",
                "new",
                "pr"
              ]
            }
          ]
        },
        {
          "discussion_number": 27,
          "comments": [
            {
              "content": [
                "'ve",
                "created",
                "17874to",
                "track",
                "let",
                "'s",
                "move",
                "conversation"
              ]
            }
          ]
        }
      ]
    }
  ],
  "issues": [
    {
      "title": [
        "referencing",
        "environment",
        "variable",
        "doesnt",
        "exist",
        "vite",
        "dump",
        "whole",
        "environment",
        "bundle",
        "object"
      ],
      "labels": [
        "p2-edge-case"
      ],
      "comments": [
        {
          "author": "joshmanders",
          "content": [
            "describe",
            "bug",
            "reference",
            "env",
            "var",
            "idea",
            "vite",
            "replace",
            "reference",
            "value",
            "env",
            "var",
            "given",
            "following",
            ".env",
            "vite_foo=foo",
            "following",
            "code",
            "console",
            "log",
            "import",
            "meta",
            "env",
            "vite_foo",
            "resulting",
            "output",
            "console",
            "log",
            "foo",
            "true",
            "work",
            "expected",
            "reference",
            "env",
            "var",
            "n't",
            "exist",
            "'d",
            "expect",
            "replacement",
            "become",
            "undefined",
            "like",
            "console",
            "log",
            "import",
            "meta",
            "env",
            "vite_foo",
            "//",
            "'foo",
            "console",
            "log",
            "import",
            "meta",
            "env",
            "vite_bar",
            "//",
            "undefined",
            "actually",
            "happens",
            "whole",
            "env",
            "object",
            "dumped",
            "directly",
            "bundle",
            "reference",
            "var",
            "defined",
            "end",
            "give",
            "undefined",
            "var",
            "vite_foo",
            "foo",
            "base_url",
            "mode",
            "production",
            "dev",
            "1",
            "prod",
            "0",
            "ssr",
            "1",
            "console",
            "log",
            "foo",
            "console",
            "log",
            "vite_bar",
            "believe",
            "wrong",
            "lead",
            "bad",
            "security",
            "leak",
            "instead",
            "output",
            "following",
            "console",
            "log",
            "foo",
            "console",
            "log",
            "undefined",
            "reproduction",
            "http",
            "//github.com/joshmanders/vite-env-bug",
            "step",
            "reproduce",
            "run",
            "npm",
            "install",
            "run",
            "npm",
            "run",
            "build",
            "inspect",
            "output",
            "dist/assets/",
            "system",
            "info",
            "system",
            "o",
            "macos",
            "14.5",
            "cpu",
            "10",
            "arm64",
            "apple",
            "m1",
            "max",
            "memory",
            "1.38",
            "gb",
            "64.00",
            "gb",
            "shell",
            "3.7.1",
            "/opt/homebrew/bin/fish",
            "binary",
            "node",
            "20.15.0",
            "/opt/homebrew/bin/node",
            "npm",
            "10.7.0",
            "/opt/homebrew/bin/npm",
            "watchman",
            "2024.06.24.00",
            "/opt/homebrew/bin/watchman",
            "browser",
            "brave",
            "browser",
            "126.1.67.123",
            "chrome",
            "126.0.6478.127",
            "edge",
            "126.0.2592.102",
            "safari",
            "17.5",
            "npmpackages",
            "vite",
            "^5.3.4",
            "5.3.4",
            "used",
            "package",
            "manager",
            "npm",
            "log",
            "click",
            "expand",
            "vite",
            "config",
            "bundled",
            "config",
            "file",
            "loaded",
            "11.67ms",
            "+0ms",
            "vite",
            "config",
            "using",
            "resolved",
            "config",
            "vite",
            "config",
            "root",
            "/users/josh/code/joshmanders/vite-env-bug",
            "vite",
            "config",
            "build",
            "vite",
            "config",
            "target",
            "es2020",
            "edge88",
            "firefox78",
            "chrome87",
            "safari14",
            "vite",
            "config",
            "csstarget",
            "es2020",
            "edge88",
            "firefox78",
            "chrome87",
            "safari14",
            "vite",
            "config",
            "outdir",
            "./dist",
            "vite",
            "config",
            "assetsdir",
            "asset",
            "vite",
            "config",
            "assetsinlinelimit",
            "4096",
            "vite",
            "config",
            "csscodesplit",
            "true",
            "vite",
            "config",
            "sourcemap",
            "false",
            "vite",
            "config",
            "rollupoptions",
            "input",
            "array",
            "vite",
            "config",
            "minify",
            "esbuild",
            "vite",
            "config",
            "terseroptions",
            "vite",
            "config",
            "write",
            "true",
            "vite",
            "config",
            "emptyoutdir",
            "null",
            "vite",
            "config",
            "copypublicdir",
            "true",
            "vite",
            "config",
            "manifest",
            "false",
            "vite",
            "config",
            "lib",
            "false",
            "vite",
            "config",
            "ssr",
            "false",
            "vite",
            "config",
            "ssrmanifest",
            "false",
            "vite",
            "config",
            "ssremitassets",
            "false",
            "vite",
            "config",
            "reportcompressedsize",
            "true",
            "vite",
            "config",
            "chunksizewarninglimit",
            "500",
            "vite",
            "config",
            "watch",
            "null",
            "vite",
            "config",
            "commonjsoptions",
            "include",
            "array",
            "extension",
            "array",
            "vite",
            "config",
            "dynamicimportvarsoptions",
            "warnonerror",
            "true",
            "exclude",
            "array",
            "vite",
            "config",
            "modulepreload",
            "polyfill",
            "true",
            "vite",
            "config",
            "cssminify",
            "true",
            "vite",
            "config",
            "vite",
            "config",
            "configfile",
            "/users/josh/code/joshmanders/vite-env-bug/vite.config.js",
            "vite",
            "config",
            "configfiledependencies",
            "/users/josh/code/joshmanders/vite-env-bug/vite.config.js",
            "vite",
            "config",
            "inlineconfig",
            "vite",
            "config",
            "root",
            "undefined",
            "vite",
            "config",
            "base",
            "undefined",
            "vite",
            "config",
            "mode",
            "undefined",
            "vite",
            "config",
            "configfile",
            "undefined",
            "vite",
            "config",
            "loglevel",
            "undefined",
            "vite",
            "config",
            "clearscreen",
            "undefined",
            "vite",
            "config",
            "build",
            "vite",
            "config",
            "vite",
            "config",
            "base",
            "vite",
            "config",
            "rawbase",
            "vite",
            "config",
            "resolve",
            "vite",
            "config",
            "mainfields",
            "browser",
            "module",
            "jsnext",
            "main",
            "jsnext",
            "vite",
            "config",
            "condition",
            "vite",
            "config",
            "extension",
            "vite",
            "config",
            ".mjs",
            ".js",
            "vite",
            "config",
            ".mts",
            ".ts",
            "vite",
            "config",
            ".jsx",
            ".tsx",
            "vite",
            "config",
            ".json",
            "vite",
            "config",
            "vite",
            "config",
            "dedupe",
            "vite",
            "config",
            "preservesymlinks",
            "false",
            "vite",
            "config",
            "alias",
            "object",
            "object",
            "vite",
            "config",
            "vite",
            "config",
            "publicdir",
            "/users/josh/code/joshmanders/vite-env-bug/public",
            "vite",
            "config",
            "cachedir",
            "/users/josh/code/joshmanders/vite-env-bug/node_modules/.vite",
            "vite",
            "config",
            "command",
            "build",
            "vite",
            "config",
            "mode",
            "production",
            "vite",
            "config",
            "ssr",
            "vite",
            "config",
            "target",
            "node",
            "vite",
            "config",
            "optimizedeps",
            "nodiscovery",
            "true",
            "esbuildoptions",
            "object",
            "vite",
            "config",
            "vite",
            "config",
            "isworker",
            "false",
            "vite",
            "config",
            "mainconfig",
            "null",
            "vite",
            "config",
            "bundlechain",
            "vite",
            "config",
            "isproduction",
            "true",
            "vite",
            "config",
            "plugins",
            "vite",
            "config",
            "vite",
            "build-metadata",
            "vite",
            "config",
            "vite",
            "watch-package-data",
            "vite",
            "config",
            "vite",
            "pre-alias",
            "vite",
            "config",
            "alias",
            "vite",
            "config",
            "vite",
            "modulepreload-polyfill",
            "vite",
            "config",
            "vite",
            "resolve",
            "vite",
            "config",
            "vite",
            "html-inline-proxy",
            "vite",
            "config",
            "vite",
            "cs",
            "vite",
            "config",
            "vite",
            "esbuild",
            "vite",
            "config",
            "vite",
            "json",
            "vite",
            "config",
            "vite",
            "wasm-helper",
            "vite",
            "config",
            "vite",
            "worker",
            "vite",
            "config",
            "vite",
            "asset",
            "vite",
            "config",
            "vite",
            "wasm-fallback",
            "vite",
            "config",
            "vite",
            "define",
            "vite",
            "config",
            "vite",
            "css-post",
            "vite",
            "config",
            "vite",
            "build-html",
            "vite",
            "config",
            "vite",
            "worker-import-meta-url",
            "vite",
            "config",
            "vite",
            "asset-import-meta-url",
            "vite",
            "config",
            "vite",
            "force-systemjs-wrap-complete",
            "vite",
            "config",
            "commonjs",
            "vite",
            "config",
            "vite",
            "data-uri",
            "vite",
            "config",
            "vite",
            "dynamic-import-vars",
            "vite",
            "config",
            "vite",
            "import-glob",
            "vite",
            "config",
            "vite",
            "build-import-analysis",
            "vite",
            "config",
            "vite",
            "esbuild-transpile",
            "vite",
            "config",
            "vite",
            "terser",
            "vite",
            "config",
            "vite",
            "reporter",
            "vite",
            "config",
            "vite",
            "load-fallback",
            "vite",
            "config",
            "vite",
            "config",
            "cs",
            "lightningcss",
            "undefined",
            "vite",
            "config",
            "esbuild",
            "jsxdev",
            "false",
            "vite",
            "config",
            "server",
            "vite",
            "config",
            "pretransformrequests",
            "true",
            "vite",
            "config",
            "sourcemapignorelist",
            "function",
            "isinnodemodules",
            "1",
            "vite",
            "config",
            "middlewaremode",
            "false",
            "vite",
            "config",
            "f",
            "vite",
            "config",
            "strict",
            "true",
            "vite",
            "config",
            "allow",
            "array",
            "vite",
            "config",
            "deny",
            "array",
            "vite",
            "config",
            "cachedchecks",
            "undefined",
            "vite",
            "config",
            "vite",
            "config",
            "vite",
            "config",
            "preview",
            "vite",
            "config",
            "port",
            "undefined",
            "vite",
            "config",
            "strictport",
            "undefined",
            "vite",
            "config",
            "host",
            "undefined",
            "vite",
            "config",
            "http",
            "undefined",
            "vite",
            "config",
            "open",
            "undefined",
            "vite",
            "config",
            "proxy",
            "undefined",
            "vite",
            "config",
            "cors",
            "undefined",
            "vite",
            "config",
            "header",
            "undefined",
            "vite",
            "config",
            "vite",
            "config",
            "envdir",
            "/users/josh/code/joshmanders/vite-env-bug",
            "vite",
            "config",
            "env",
            "vite",
            "config",
            "vite_foo",
            "foo",
            "vite",
            "config",
            "base_url",
            "vite",
            "config",
            "mode",
            "production",
            "vite",
            "config",
            "dev",
            "false",
            "vite",
            "config",
            "prod",
            "true",
            "vite",
            "config",
            "vite",
            "config",
            "assetsinclude",
            "function",
            "assetsinclude",
            "vite",
            "config",
            "logger",
            "vite",
            "config",
            "haswarned",
            "false",
            "vite",
            "config",
            "info",
            "function",
            "info",
            "vite",
            "config",
            "warn",
            "function",
            "warn",
            "vite",
            "config",
            "warnonce",
            "function",
            "warnonce",
            "vite",
            "config",
            "error",
            "function",
            "error",
            "vite",
            "config",
            "clearscreen",
            "function",
            "clearscreen",
            "vite",
            "config",
            "haserrorlogged",
            "function",
            "haserrorlogged",
            "vite",
            "config",
            "vite",
            "config",
            "packagecache",
            "map",
            "1",
            "vite",
            "config",
            "fnpd_/users/josh/code/joshmanders/vite-env-bug",
            "vite",
            "config",
            "dir",
            "/users/josh/code/joshmanders/vite-env-bug",
            "vite",
            "config",
            "data",
            "object",
            "vite",
            "config",
            "hassideeffects",
            "function",
            "hassideeffects",
            "vite",
            "config",
            "webresolvedimports",
            "vite",
            "config",
            "noderesolvedimports",
            "vite",
            "config",
            "setresolvedcache",
            "function",
            "setresolvedcache",
            "vite",
            "config",
            "getresolvedcache",
            "function",
            "getresolvedcache",
            "vite",
            "config",
            "vite",
            "config",
            "set",
            "function",
            "anonymous",
            "vite",
            "config",
            "vite",
            "config",
            "createresolver",
            "function",
            "createresolver",
            "vite",
            "config",
            "optimizedeps",
            "vite",
            "config",
            "holduntilcrawlend",
            "true",
            "vite",
            "config",
            "esbuildoptions",
            "preservesymlinks",
            "false",
            "vite",
            "config",
            "vite",
            "config",
            "worker",
            "format",
            "iife",
            "plugins",
            "plugins",
            "rollupoptions",
            "vite",
            "config",
            "apptype",
            "spa",
            "vite",
            "config",
            "experimental",
            "importglobrestoreextension",
            "false",
            "hmrpartialaccept",
            "false",
            "vite",
            "config",
            "getsortedplugins",
            "function",
            "getsortedplugins",
            "vite",
            "config",
            "getsortedpluginhooks",
            "function",
            "getsortedpluginhooks",
            "vite",
            "config",
            "+17ms",
            "validation",
            "follow",
            "code",
            "conduct",
            "read",
            "contributing",
            "guideline",
            "read",
            "doc",
            "check",
            "n't",
            "already",
            "issue",
            "report",
            "bug",
            "avoid",
            "creating",
            "duplicate",
            "make",
            "sure",
            "vite",
            "issue",
            "framework-specific",
            "issue",
            "example",
            "'s",
            "vue",
            "sfc",
            "related",
            "bug",
            "likely",
            "reported",
            "vuejs/core",
            "instead",
            "check",
            "concrete",
            "bug",
            "q",
            "open",
            "github",
            "discussion",
            "join",
            "discord",
            "chat",
            "server",
            "provided",
            "reproduction",
            "minimal",
            "reproducible",
            "example",
            "bug"
          ]
        },
        {
          "author": "innocenzi",
          "content": [
            "oh",
            "lol",
            "related",
            "http",
            "//github.com/vitejs/vite/pull/17701"
          ]
        },
        {
          "author": "jnoordsij",
          "content": [
            "ran",
            "well",
            "side",
            "surprised",
            "vite_bar",
            "defined",
            "environment",
            "actually",
            "left",
            "outputted",
            "code",
            "somevar",
            ".vite_bar",
            "rather",
            "replaced",
            "undefined",
            "optimized",
            "usecase",
            "debug-variable",
            "set",
            "specific",
            "value",
            "local",
            "development",
            "environment",
            "change",
            "behavior",
            "define",
            "production",
            "build",
            "environment",
            "hoping",
            "would",
            "entirely",
            "remove",
            "code",
            "thinking",
            "'s",
            "combination",
            "possible",
            "thing",
            "done",
            "eye",
            "improve",
            "current",
            "behavior",
            "emit",
            "warning",
            "building",
            "bundle",
            "environment",
            "variable",
            "missing",
            "e.g",
            "scan",
            "prefix-matching",
            "pattern",
            "notify",
            "user",
            "environment",
            "variable",
            "referenced",
            "set",
            "warning",
            "variable",
            "vite_bar",
            "referenced",
            "value",
            "found",
            "including",
            "environment",
            "output",
            "bundle",
            "allow",
            "user",
            "config",
            "flag",
            "automatically",
            "replace",
            "prefixed",
            "env",
            "value",
            "undefined",
            "set",
            "update",
            "documentation",
            "environment",
            "variable",
            "clearly",
            "explain",
            "reflect",
            "current",
            "behavior",
            "find",
            "somewhat",
            "counterintuitive",
            "point",
            "allow",
            "user",
            "list/declare",
            "allowed",
            "environment",
            "variable",
            "config",
            "file",
            "potentially",
            "even",
            "fallback",
            "value",
            "replace",
            "alternative",
            "prefix",
            "issue",
            "description",
            "n't",
            "think",
            "dump",
            "whole",
            "environment",
            "build",
            "rather",
            "'s",
            "value",
            "value",
            "correct",
            "prefix",
            "building",
            "console.info",
            "import.meta.env.vite_bar",
            "vite_foo=foo",
            "secret_var=s3cr3t",
            "vite",
            "build",
            "result",
            "j",
            "var",
            "e=",
            "vite_foo",
            "foo",
            "base_url",
            "mode",
            "production",
            "dev",
            "1",
            "prod",
            "0",
            "ssr",
            "1",
            "console.info",
            "e.vite_bar",
            "thus",
            "potential",
            "security",
            "issue",
            "bit",
            "limited/subtle"
          ]
        },
        {
          "author": "bluwy",
          "content": [
            "http",
            "//github.com/vitejs/vite/pull/17648",
            "fix",
            "still",
            "n't",
            "put",
            "sensitive",
            "information",
            "import.meta.env",
            "first",
            "place",
            "could",
            "cause",
            "security",
            "risk",
            "non-secret",
            "variable",
            "kept"
          ]
        },
        {
          "author": "bluwy",
          "content": [
            "vite",
            "assumes",
            "anything",
            "import.meta.env",
            "safe",
            "public",
            "expose",
            "everything",
            "need",
            "'s",
            "never",
            "meant",
            "hold",
            "secret",
            "variable",
            "first",
            "place",
            "fact",
            "dev",
            "'ll",
            "expose",
            "everything",
            "default",
            "perf",
            "optimization",
            "ever",
            "start",
            "dev",
            "--",
            "host",
            "'d",
            "open",
            "attack",
            "plugin",
            "put",
            "secret",
            "variable",
            "import.meta.env",
            "plugin",
            "imposes",
            "security",
            "risk",
            "vite",
            "ca",
            "n't",
            "misuse",
            "feature",
            "blame",
            "vite",
            "'s",
            "security",
            "right"
          ]
        },
        {
          "author": "jnoordsij",
          "content": [
            "able",
            "put",
            "anything",
            "want",
            "import.meta.env",
            "security",
            "risk",
            "vite",
            "dumping",
            "unused",
            "env",
            "var",
            "final",
            "bundle",
            "something",
            "referenced",
            "n't",
            "defined",
            "never",
            "use",
            "import.meta.env.super_secret",
            "codebase",
            "'s",
            "defined",
            "env",
            "n't",
            "ever",
            "exposed",
            "frontend",
            "3rd",
            "party",
            "package",
            "reference",
            "import.meta.env.doesnt_exist",
            "fyi",
            "even",
            "issue",
            "completely",
            "remedied",
            "expose",
            "much",
            "data",
            "import.meta.env",
            "still",
            "run",
            "risk",
            "malicious",
            "unknowing",
            "third",
            "party",
            "package",
            "referencing",
            "import.meta.env.super_secret",
            "code",
            "silently",
            "exposing",
            "secret",
            "anyways"
          ]
        },
        {
          "author": "jnoordsij",
          "content": [
            "preface",
            "'m",
            "deny",
            "behavior",
            "buggy/confusing",
            "way",
            "trying",
            "clarify",
            "behavior",
            "potential",
            "impact",
            "mentioned",
            "also",
            "think",
            "behavior",
            "potentially",
            "confusing",
            "and/or",
            "misleading",
            "thing",
            "could",
            "done",
            "improve",
            "'s",
            "solution",
            "still",
            "drawback",
            "still",
            "requires",
            "user",
            "careful",
            "think",
            "might",
            "confusing",
            "regarding",
            "vite",
            "dump",
            "whole",
            "environment",
            "part",
            "default",
            "vite",
            "look",
            "environment",
            "variable",
            "prefixed",
            "vite_",
            "prefix",
            "alter",
            "config",
            "definition",
            "variable",
            "exposed",
            "frontend",
            "bundle",
            "code",
            "i.e",
            "including",
            "third",
            "party",
            "code",
            "regardless",
            "whether",
            "dumped",
            "described",
            "issue",
            "default",
            "import.meta.env.super_secret",
            "thus",
            "exposed",
            "way",
            "default",
            "config",
            "vite_",
            "prefix",
            "clearly",
            "n't",
            "'s",
            "exact",
            "reason",
            "17701",
            "closed",
            "somehow",
            "manage",
            "include",
            "import.meta.env",
            "bypassing",
            "inplace",
            "security",
            "check",
            "subject",
            "leaking",
            "mean",
            "like",
            "third",
            "party",
            "code",
            "even",
            "dump",
            "issue",
            "would",
            "removed",
            "therefore",
            "security",
            "issue",
            "hand",
            "really",
            "tied",
            "fixed",
            "removing",
            "dump",
            "like",
            "suggested",
            "altering",
            "current",
            "behavior",
            "expose",
            "variable",
            "vite_",
            "prefix",
            "would",
            "viable",
            "would",
            "able",
            "add",
            "config",
            "strictly",
            "controlled",
            "list",
            "variable",
            "'d",
            "want",
            "expose",
            "would",
            "put",
            "control",
            "exposed",
            "variable",
            "user",
            "hand",
            "allow",
            "easier",
            "sharing",
            "non-secret",
            "variable",
            "multiple",
            "applications/tools",
            "17701",
            "intending",
            "still",
            "limiting",
            "exposed",
            "variable",
            "manually",
            "picked",
            "set",
            "avoiding",
            "security",
            "issue",
            "see",
            "also",
            "doc",
            "http",
            "//vitejs.dev/guide/env-and-mode.html",
            "env-files",
            "prevent",
            "accidentally",
            "leaking",
            "env",
            "variable",
            "client",
            "variable",
            "prefixed",
            "vite_",
            "exposed",
            "vite-processed",
            "code"
          ]
        }
      ]
    },
    {
      "title": [
        "vite",
        "5.4.0",
        "env",
        "var",
        "fails",
        "bundling",
        "vite-bundled",
        "library"
      ],
      "labels": [
        "regression",
        "p4-important"
      ],
      "comments": [
        {
          "author": "bluwy",
          "content": [
            "describe",
            "bug",
            "brought",
            "17648",
            "comment",
            "library",
            "us",
            "vite",
            "library",
            "mode",
            "bundle",
            "us",
            "env",
            "var",
            "const",
            "__vite_import_meta_env__",
            "may",
            "get",
            "included",
            "code",
            "happens",
            "bundle",
            "library",
            "app",
            "re-inject",
            "variable",
            "declaration",
            "cause",
            "runtime",
            "error",
            "vite/packages/vite/src/node/plugins/define.ts",
            "line",
            "139",
            "148",
            "fcf50c2",
            "//",
            "'s",
            "bare",
            "import.meta.env",
            "reference",
            "prepend",
            "banner",
            "bareimportmetaenvre",
            "test",
            "result",
            "code",
            "result",
            "code",
            "banner",
            "result",
            "code",
            "result",
            "map",
            "const",
            "map",
            "json",
            "parse",
            "result",
            "map",
            "map",
            "mapping",
            "map",
            "mapping",
            "result",
            "map",
            "map",
            "reproduction",
            "silverwind/vite-import-meta",
            "1",
            "step",
            "reproduce",
            "response",
            "system",
            "info",
            "n/a",
            "used",
            "package",
            "manager",
            "npm",
            "log",
            "click",
            "expand",
            "error",
            "build",
            "commonjs",
            "--",
            "resolver",
            "node_modules/lib/dist/index.js",
            "3392:6",
            "identifier",
            "__vite_import_meta_env__",
            "already",
            "declared",
            "file",
            "node_modules/lib/dist/index.js:3392:6",
            "3390",
            "const",
            "create",
            "createstate",
            "createstate",
            "createimpl",
            "createstate",
            "createimpl",
            "3391",
            "const",
            "__vite_import_meta_env__",
            "base_url",
            "dev",
            "false",
            "mode",
            "production",
            "prod",
            "true",
            "ssr",
            "false",
            "3392",
            "function",
            "createjsonstorage",
            "getstorage",
            "options2",
            "3393",
            "let",
            "storage",
            "3394",
            "try",
            "getrolluperror",
            "node_modules/vite/node_modules/rollup/dist/es/shared/parseast.js:392:41",
            "error",
            "node_modules/vite/node_modules/rollup/dist/es/shared/parseast.js:388:42",
            "module.error",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:13944:16",
            "modulescope.adddeclaration",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:7362:21",
            "modulescope.adddeclaration",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:12075:22",
            "identifier.declare",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:6960:39",
            "variabledeclarator.declaredeclarator",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:10661:17",
            "variabledeclaration.initialise",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:12343:24",
            "convertnode",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:13167:10",
            "convertnodelist",
            "node_modules/vite/node_modules/rollup/dist/es/shared/node-entry.js:13177:34",
            "validation",
            "follow",
            "code",
            "conduct",
            "read",
            "contributing",
            "guideline",
            "read",
            "doc",
            "check",
            "n't",
            "already",
            "issue",
            "report",
            "bug",
            "avoid",
            "creating",
            "duplicate",
            "make",
            "sure",
            "vite",
            "issue",
            "framework-specific",
            "issue",
            "example",
            "'s",
            "vue",
            "sfc",
            "related",
            "bug",
            "likely",
            "reported",
            "vuejs/core",
            "instead",
            "check",
            "concrete",
            "bug",
            "q",
            "open",
            "github",
            "discussion",
            "join",
            "discord",
            "chat",
            "server",
            "provided",
            "reproduction",
            "minimal",
            "reproducible",
            "example",
            "bug"
          ]
        },
        {
          "author": "yuzheng14",
          "content": [
            "think",
            "could",
            "use",
            "virtual",
            "module",
            "like",
            "vite",
            "importanalysisbuild",
            "let",
            "rollup",
            "handle",
            "name"
          ]
        },
        {
          "author": "yuzheng14",
          "content": [
            "'ve",
            "created",
            "http",
            "//github.com/vitejs/vite/pull/17876",
            "fix"
          ]
        },
        {
          "author": "pedro-rodrigues-la",
          "content": [
            "also",
            "encountered",
            "issue",
            "case",
            "react",
            "library",
            "created",
            "using",
            "vite",
            "used",
            "another",
            "project",
            "also",
            "using",
            "react",
            "vite",
            "library",
            "project",
            "us",
            "import.meta",
            "statement",
            "variable",
            "declared",
            "name",
            "env",
            "variable",
            "default",
            "one",
            "created",
            "vite",
            "seems",
            "one",
            "causing",
            "conflict",
            "error",
            "build",
            "project/dist/project.js",
            "2345:6",
            "identifier",
            "__vite_import_meta_env__",
            "already",
            "declared"
          ]
        }
      ]
    }
  ],
  "security": null
}