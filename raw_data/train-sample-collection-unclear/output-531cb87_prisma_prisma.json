{
  "commit_index": "531cb87",
  "commit_url": "https://github.com/prisma/prisma/commit/531cb879ddcc8889a7320b5e55a120988d7bec3d",
  "commit": {
    "commit_message": [
      "fix",
      "error",
      "handling",
      "ensure",
      "also",
      "unknown",
      "error",
      "interactive",
      "tr\u2026"
    ],
    "description": [
      "unknown",
      "error",
      "interactive",
      "transaction",
      "commits",
      "would",
      "properly",
      "fail",
      "transaction",
      "although",
      "rolled",
      "back",
      "error",
      "could",
      "occur",
      "e.g",
      "due",
      "failing",
      "db",
      "trigger",
      "fix",
      "17303"
    ],
    "changed_files_count": 9,
    "changed_files": [
      "packages/client/src/runtime/core/engines/library/LibraryEngine.ts",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/_steps.ts",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/package.json",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/prisma/migrations/20250123182627_test/migration.sql",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/prisma/migrations/migration_lock.toml",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/prisma/schema.prisma",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/readme.md",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/tests/index.ts",
      "packages/client/tests/e2e/17303-interactive-transaction-errors/tsconfig.json"
    ],
    "changed_files_content": [],
    "parent": "9cf9cccda1a8957003c68979aec754abd7d54c1d"
  },
  "pull_requests": [
    {
      "pr_title": [
        "fix",
        "error",
        "handling",
        "ensure",
        "also",
        "unknown",
        "error",
        "interactive",
        "transaction",
        "fail",
        "properly",
        "26166"
      ],
      "total_discussions": 3,
      "discussions": [
        {
          "discussion_number": 1,
          "comments": [
            {
              "type": "pr_description",
              "content": [
                "unknown",
                "error",
                "interactive",
                "transaction",
                "commits",
                "would",
                "properly",
                "fail",
                "transaction",
                "although",
                "rolled",
                "back.such",
                "error",
                "could",
                "occur",
                "e.g",
                "due",
                "failing",
                "db",
                "triggers.fixes",
                "17303"
              ],
              "author": "FGoessler"
            }
          ]
        },
        {
          "discussion_number": 2,
          "comments": [
            {
              "content": [
                "comparingfix/orm-439-fix-interactive-transaction-failure-due-to-db-triggers",
                "3809615",
                "withmain",
                "d45607d",
                "3untouched",
                "benchmark"
              ]
            }
          ]
        },
        {
          "discussion_number": 3,
          "comments": [
            {
              "content": [
                "good",
                "pr",
                "longer",
                "us",
                "custom",
                "engine"
              ]
            }
          ]
        }
      ]
    }
  ],
  "issues": [
    {
      "title": [
        "prisma",
        "interactive",
        "transaction",
        "ignores",
        "db",
        "exception",
        "commit",
        "trigger"
      ],
      "labels": [
        "bug/2-confirmed",
        "kind/bug",
        "topic: postgresql",
        "domain/client",
        "topic: database triggers",
        "topic: interactiveTransactions"
      ],
      "comments": [
        {
          "author": "Siegrift",
          "content": [
            "bug",
            "description",
            "created",
            "repro",
            "http",
            "//github.com/siegrift/prisma-interactive-tx-bug-repro/tree/trigger",
            "two",
            "model",
            "user",
            "deposit",
            "remember",
            "balance",
            "field",
            "user",
            "table",
            "want",
            "consistent",
            "sum",
            "deposit",
            "using",
            "psql",
            "constraint",
            "trigger",
            "noticed",
            "trigger",
            "failed",
            "prisma",
            "silently",
            "resolved",
            "promise",
            "error",
            "log",
            "able",
            "find",
            "error",
            "inside",
            "log",
            "database",
            "reproduce",
            "see",
            "http",
            "//github.com/siegrift/prisma-interactive-tx-bug-repro/tree/trigger",
            "expected",
            "behavior",
            "prisma",
            "notice",
            "db",
            "commit",
            "failed",
            "gracefully",
            "reject",
            "promise",
            "prisma",
            "information",
            "see",
            "http",
            "//github.com/siegrift/prisma-interactive-tx-bug-repro/tree/trigger",
            "environment",
            "setup",
            "o",
            "macos",
            "database",
            "postgresql",
            "node.js",
            "version",
            "v18.12.1",
            "prisma",
            "version",
            "prisma",
            "4.8.1",
            "prisma/client",
            "4.8.1",
            "current",
            "platform",
            "darwin-arm64",
            "query",
            "engine",
            "node-api",
            "libquery-engine",
            "d6e67a83f971b175a593ccc12e15c4a757f93ffe",
            "node_modules/",
            "prisma/engines/libquery_engine-darwin-arm64.dylib.node",
            "migration",
            "engine",
            "migration-engine-cli",
            "d6e67a83f971b175a593ccc12e15c4a757f93ffe",
            "node_modules/",
            "prisma/engines/migration-engine-darwin-arm64",
            "introspection",
            "engine",
            "introspection-core",
            "d6e67a83f971b175a593ccc12e15c4a757f93ffe",
            "node_modules/",
            "prisma/engines/introspection-engine-darwin-arm64",
            "format",
            "binary",
            "prisma-fmt",
            "d6e67a83f971b175a593ccc12e15c4a757f93ffe",
            "node_modules/",
            "prisma/engines/prisma-fmt-darwin-arm64",
            "format",
            "wasm",
            "prisma/prisma-fmt-wasm",
            "4.8.0-61.d6e67a83f971b175a593ccc12e15c4a757f93ffe",
            "default",
            "engine",
            "hash",
            "d6e67a83f971b175a593ccc12e15c4a757f93ffe",
            "studio",
            "0.479.0"
          ]
        },
        {
          "author": "janpio",
          "content": [
            "next",
            "step",
            "someone",
            "side",
            "reproduce",
            "provided",
            "repository",
            "unfortunately",
            "seem",
            "affect",
            "many",
            "people",
            "chance",
            "picked",
            "next",
            "day",
            "low",
            "_will_",
            "get",
            "tit",
            "eventually",
            "eta"
          ]
        },
        {
          "author": "jbwc",
          "content": [
            "experiencing",
            "issue",
            "work",
            "fine",
            "array",
            "approach",
            "prisma.",
            "transaction",
            "query1",
            "query2",
            "fails",
            "using",
            "interactive",
            "transaction",
            "prisma.",
            "transaction",
            "prisma",
            "await",
            "query1",
            "await",
            "query2",
            "log",
            "db",
            "img",
            "width=",
            "1714",
            "alt=",
            "image",
            "src=",
            "http",
            "//github.com/prisma/prisma/assets/126919187/0ebd40fd-cdde-4760-833c-efdd6a2246f3",
            "test",
            "fails",
            "record",
            "erroneously",
            "returned",
            "even",
            "though",
            "db",
            "raised",
            "exception",
            "img",
            "width=",
            "1010",
            "alt=",
            "image",
            "src=",
            "http",
            "//github.com/prisma/prisma/assets/126919187/8213fb43-6e87-4cc1-967c-3511435aaf35",
            "related",
            "stackoverflow",
            "issue",
            "came",
            "across",
            "well",
            "http",
            "//stackoverflow.com/questions/74218793/prisma-transaction-wont-raise-an-exception-when-postgres-deferrable-initially"
          ]
        },
        {
          "author": "janpio",
          "content": [
            "jbwc",
            "case",
            "also",
            "use",
            "trigger",
            "seems",
            "indicated",
            "cause",
            "original",
            "issue",
            "want",
            "make",
            "sure",
            "actually",
            "_same_",
            "problem",
            "side",
            "note",
            "stackoverflow",
            "link",
            "unfortunately",
            "404"
          ]
        },
        {
          "author": "jbwc",
          "content": [
            "yes",
            "case",
            "also",
            "us",
            "trigger"
          ]
        },
        {
          "author": "bxjx",
          "content": [
            "believe",
            "'m",
            "also",
            "experiencing",
            "issue",
            "took",
            "look",
            "generated",
            "code",
            "believe",
            "traced",
            "code",
            "http",
            "//github.com/prisma/prisma/blob/cb7aa393338d60f63241a2e4b36d24d45c4fffb0/packages/client/src/runtime/core/engines/library/libraryengine.ts",
            "l163",
            "situation",
            "deferred",
            "constraint",
            "get",
            "triggered",
            "end",
            "transaction",
            "engine",
            "correctly",
            "generated",
            "error",
            "json",
            "however",
            "error",
            "seemed",
            "missing",
            "error_code",
            "field",
            "therefore",
            "treated",
            "user",
            "error",
            "code",
            "continues",
            "without",
            "throwing",
            "returned",
            "payload",
            "field",
            "interactivetransactioninfo",
            "'m",
            "sure",
            "checking",
            "people",
            "expecting",
            "is_panic",
            "false",
            "message",
            "'error",
            "connector",
            "error",
            "querying",
            "database",
            "error",
            "conflicting",
            "key",
            "value",
            "violates",
            "exclusion",
            "constraint",
            "constraint_sortorder_idx",
            "\\n",
            "'detail",
            "key",
            "id",
            "campaignid",
            "sortorder",
            "removed_for_privacy",
            "removed_for_privacy",
            "0",
            "conflict",
            "existing",
            "key",
            "id",
            "campaignid",
            "sortorder",
            "removed_for_privacy",
            "removed_for_privacy",
            "0",
            "backtrace",
            "null",
            "everyone",
            "'s",
            "help",
            "let",
            "know",
            "provide",
            "detail"
          ]
        }
      ]
    }
  ],
  "security": null
}